---
sidebar_position: 5
title: Develop a Squid
---


# Development flow

## 1. Model the data with a schema file

Start development by defining the schema of the target database via `schema.graphql`. The schema file also defines
the shape of the GraphQL API of the squid. Schema definition consists of regular graphql type declarations annotated with custom directives to define:
- relations between the entities
- entity properties, property types and constraints 
- indexes to be created in the database

Full description of `schema.graphql` dialect is available [here](/docs/develop-a-squid/schema-spec).

## 2. Generate TypeORM classes

Mapping developers use [TypeORM](https://typeorm.io) entities
to interact with the target database during the data processing. All necessary entity classes are
generated by the squid framework from `schema.graphql`. This is done by running `npx squid-typeorm-codegen`
command.

### 3. Generate database migration

All database changes are applied through migration files located at `db/migrations`.
`squid-typeorm-migration(1)` tool provides several commands to drive the process.
It is all [TypeORM](https://typeorm.io/#/migrations) under the hood.

```bash
# Connect to database, analyze its state and generate migration to match the target schema.
# The target schema is derived from entity classes generated earlier.
# Don't forget to compile your entity classes beforehand!
npx squid-typeorm-migration generate

# Create template file for custom database changes
npx squid-typeorm-migration create

# Apply database migrations from `db/migrations`
npx squid-typeorm-migration apply

# Revert the last performed migration
npx squid-typeorm-migration revert         
```

### 4. Define a squid processor and data handlers

A squid processor is an separate node.js process that fetches historical on-chain data, performs arbitrary transformations and saves the result into the target database schema defined above. 

Subsquid SDK currently offers support only for Substrate-based chains with two base classes for data processing: `SubstrateBatchProcessor`(recommended) and `SubstrateProcessor`. 

The structure for working with a processor instance is the following:

- Initialize the processor by defining the archive data source for the network to be indexed. See [Processor config]() for details.
- Specify which data should be fetched by the processor. The data selectors may depend on the type of the source chain. For Substrate chains one can subscribe for block data, call data, or runtime events. Additional options are available for substrate chains supporting EVM and WASM contracts.  See [Data Selectors]().
- Generate typescript definitions for substrate events, calls, evm and wasm logs requested by the processor. This step is optional but is highly recommended since it allows to catch most data wrangling bugs at compile time.  See [Typegen]().
- Define handler(s) that transform the data and save it into the target database schema. See [Data handlers]()
- Run the processor 

