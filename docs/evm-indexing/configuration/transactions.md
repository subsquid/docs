---
sidebar_position: 30
description: >-
  Set filters and data selectors for transactions
---

# EVM transactions 

**`addTransaction(address: string | string[], options?)`**: Subscribe to transactions data. The first argument specifies a single address or an array of addresses to which the transaction has been submitted. An empty array means that all transactions will be selected (matching the optional `options` filter if provided). 

## Filters

The `options` argument specifies additional filtering options and a data selector which tells which transaction data should be fetched from the archive. Currently, the following filters are accepted:
+ `from?: string | string[]`: Specify and address or a set of addresses of the tx sender. Supported since `@subsquid/evm-processor@0.4.0`.
+ `range?: { from: number, to?: number | undefined } | undefined`;
+ `sighash?: string | undefined`: [First four bytes](https://ethereum.org/en/developers/docs/transactions/#the-data-field) of the Keccak hash (SHA3) of the canonical representation of the function signature.

:::info
Typescript ABI modules generated by [`squid-evm-typegen`](/evm-indexing/squid-evm-typegen) provide function sighashes as constants, e.g.

```ts
  import * as erc20abi from './abi/erc20'
  // ...
    sighash: erc20abi.functions.transfer.sighash,
  // ...
```
:::

## Data selectors

The optional `data?` field is expected to contain a [data selector](/evm-indexing/configuration/data-selectors):
```ts
data: {
  transaction: {
    // a subset of field of EvmTransactions 
    // to be fetched by the processor
  }
}
```
The requested fields will be populated in the corresponding [items](/evm-indexing/context-interfaces) of the `processor.run()` context.

## Examples

1) Request all EVM calls to the contract `0x6a2d262D56735DbA19Dd70682B39F6bE9a931D98`:
```ts
processor.addTransaction('0x6a2d262d56735dba19dd70682b39f6be9a931d98')
```

2) Request all transactions matching sighash of `transfer(address,uint256)`:
```ts
processor.addTransaction([], {sighash: '0xa9059cbb'})
```

3) Request all `transfer(address,uint256)` to the specified addresses, from block `6_000_000` onwards and fetch only inputs:
```ts
processor.addTransaction([
  '0x6a2d262d56735dba19dd70682b39f6be9a931d98',
  '0x3795c36e7d12a8c252a20c5a7b455f7c57b60283'
], {
  range: {
    from: 6_000_000
  },
  sighash: '0xa9059cbb',
  data: {
    transaction: {
      input: true
    }
  }
})
```

4) Mine all transactions to and from Vitalik Buterin's address [`vitalik.eth`](https://etherscan.io/address/vitalik.eth):

```ts
const processor = new EvmBatchProcessor()
  .setDataSource({
     archive: lookupArchive('eth-mainnet'),
  })
  // Txs sent to vitalik.eth
  .addTransaction(['0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045'], {
    data: {
      transaction: {
        from: true,
        value: true,
        hash: true
      }
    }
  })
  // Txs sent from vitalik.eth
  .addTransaction([], {
    from: '0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045',
    data: {
      transaction: {
        from: true,
        value: true,
        hash: true
      }
    }
  });

processor.run(new TypeormDatabase(), async (ctx) => {
  for (let c of ctx.blocks) {
    for (let i of c.items) {
      assert(i.kind == 'transaction')
      // just output the tx data to console
      ctx.log.info(i.transaction, 'Tx:')
    }
   }
});

```
