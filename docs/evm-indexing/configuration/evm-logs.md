---
sidebar_position: 20
description: >-
  Subscribe to event data with addLog()
---

# EVM logs

**Disclaimer: This page has been (re)written for ArrowSquid, but it is still work in progress. It may contain broken links and memos left by the documentation developers.**

:::warning
Processor data subscription methods guarantee that all data mathing their filters will be retrieved, but for technical reasons non-matching data may be added to the [batch context iterables](/arrowsquid/evm-indexing/context-interfaces/#blockdata). As such, it is important to always filter the data within the batch handler.
:::

**`addLog(options)`**: Subscribe to events/EVM log data. The `options` object has the following structure:
```typescript
{
  // filters
  address?: string[]
  topic0?: string[]
  range?: {from: number, to?: number}

  // related data retrieval
  transaction?: boolean
}
```
The filters here are:
+ `address`: the set of addresses of contracts emitting the logs. Omit it or set to `undefined` to subscribe to events from any address.
+ `topic0`: the set of values of `topic0`. Omit it or set to `undefined` to subscribe to any event.
+ `range`: the range of blocks where the logs should be looked for.

[//]: # (!!!! Update when the filter set stabilizes)

Enabling the `transaction` flag will cause the processor to retrieve all parent transactions and add them to the `transactions` iterable within the [block data](/arrowsquid/evm-indexing/context-interfaces/#blockdata).

Note that logs can also be requested by the [`addTransaction()`](../transactions) method as related data.

[//]: # (???? Check whether the final version adds the logs to the items, too)

Selection of the exact data to be retrieved for each log and its optional parent transaction is done with the `setFields()` method documented on the [Data selection](../data-selection) page. Some examples are available below.

## Examples

Fetch `NewGravatar(uint256,address,string,string)` and `UpdateGravatar(uint256,address,string,string)` event logs emitted by `0x2E645469f354BB4F5c8a05B3b30A929361cf77eC`. For each log, fetch topic set, log data. Fetch parent transactions with their inputs.

[//]: # (!!!! change the archive URL back once archive-registry has arrowsquid archives)

```ts
const processor = new EvmBatchProcessor()
  .setDataSource({
    archive: 'https://v2.archive.subsquid.io/network/ethereum-mainnet',
    chain: 'https://eth-rpc.gateway.pokt.network'
  })
  .setFinalityConfirmation(75)
  .addLog({
    address: ['0x2e645469f354bb4f5c8a05b3b30a929361cf77ec'],
    topic0: [
      // topic: 'NewGravatar(uint256,address,string,string)'
      '0x9ab3aefb2ba6dc12910ac1bce4692cf5c3c0d06cff16327c64a3ef78228b130b',
      // topic: 'UpdatedGravatar(uint256,address,string,string)'
      '0x76571b7a897a1509c641587568218a290018fbdc8b9a724f17b77ff0eec22c0c',
    ],
    transaction: true
  })
  .setFields({
    log: {
      topics: true,
      data: true
    },
    transaction: {
      input: true
    }
  })
```

:::info
Typescript ABI modules generated by [`squid-evm-typegen`](/evm-indexing/squid-evm-typegen) provide event signatures/topic0 values as constants, e.g.

```ts
  import * as gravatarAbi from './abi/gravatar'
  // ...
    topic0: [
      gravatarAbi.events.NewGravatar.topic,
      gravatarAbi.events.UpdatedGravatar.topic,
    ],
  // ...
```
:::

[//]: # (!!!! restore the second example from commit af65797005511332462064c390a471761b7578b0 once the processor is capable of that)
